<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎮 游戏系统状态 - 实时监控</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #4fd1c7, #06b6d4);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .card-title {
            font-size: 1.2rem;
            color: #4fd1c7;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-indicator {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-online { background: #10b981; color: white; }
        .status-offline { background: #ef4444; color: white; }
        .status-loading { background: #f59e0b; color: white; }

        .refresh-button {
            background: linear-gradient(45deg, #4fd1c7, #06b6d4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 209, 199, 0.4);
        }

        .game-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .game-link {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-decoration: none;
            color: #4fd1c7;
            text-align: center;
            transition: all 0.3s ease;
            display: block;
        }

        .game-link:hover {
            background: rgba(79, 209, 199, 0.1);
            border-color: #4fd1c7;
            transform: translateY(-2px);
        }

        .auto-refresh {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.9rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loading {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="auto-refresh">
        <div>🔄 自动刷新: <span id="countdown">10</span>s</div>
        <div>📊 最后更新: <span id="lastUpdate">--:--:--</span></div>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="title">🎮 游戏系统状态监控</h1>
            <div>
                <button class="refresh-button" onclick="checkAllStatus()">🔄 立即刷新</button>
                <button class="refresh-button" onclick="toggleAutoRefresh()">⏸️ 暂停自动刷新</button>
            </div>
        </div>

        <div class="status-grid">
            <!-- HTTP服务器状态 -->
            <div class="status-card">
                <h3 class="card-title">🌐 HTTP服务器</h3>
                <div id="server-status">
                    <div class="status-item">
                        <span>服务状态</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>端口</span>
                        <span>8000</span>
                    </div>
                    <div class="status-item">
                        <span>响应时间</span>
                        <span id="response-time">--ms</span>
                    </div>
                </div>
            </div>

            <!-- 游戏文件状态 -->
            <div class="status-card">
                <h3 class="card-title">📁 游戏文件</h3>
                <div id="files-status">
                    <div class="status-item">
                        <span>完整游戏</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>快速试玩</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>测试中心</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>启动中心</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                </div>
            </div>

            <!-- 游戏资源状态 -->
            <div class="status-card">
                <h3 class="card-title">⚙️ 游戏资源</h3>
                <div id="resources-status">
                    <div class="status-item">
                        <span>样式文件</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>核心脚本</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>测试框架</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>粒子效果</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                </div>
            </div>

            <!-- 浏览器兼容性 -->
            <div class="status-card">
                <h3 class="card-title">🌐 浏览器兼容性</h3>
                <div id="browser-status">
                    <div class="status-item">
                        <span>Canvas 2D</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>ES6 支持</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>本地存储</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                    <div class="status-item">
                        <span>性能API</span>
                        <span class="status-indicator loading">检查中...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 快速访问链接 -->
        <div class="game-links">
            <a href="launch-game.html" class="game-link" target="_blank">
                🚀 游戏启动中心
            </a>
            <a href="game.html" class="game-link" target="_blank">
                🎮 完整游戏
            </a>
            <a href="play-game.html" class="game-link" target="_blank">
                ⚡ 快速试玩
            </a>
            <a href="complete-test.html" class="game-link" target="_blank">
                🧪 测试中心
            </a>
            <a href="tests/TestRunner.html" class="game-link" target="_blank">
                🔬 单元测试
            </a>
            <a href="index.html" class="game-link" target="_blank">
                🏠 项目主页
            </a>
        </div>
    </div>

    <script>
        let autoRefreshEnabled = true;
        let refreshInterval;
        let countdownInterval;

        // 检查服务器状态
        async function checkServerStatus() {
            const start = performance.now();
            try {
                const response = await fetch('/');
                const end = performance.now();
                const responseTime = Math.round(end - start);
                
                document.getElementById('response-time').textContent = responseTime + 'ms';
                
                if (response.ok) {
                    updateStatus('server-status', '服务状态', 'online', '在线');
                } else {
                    updateStatus('server-status', '服务状态', 'offline', '异常');
                }
            } catch (error) {
                updateStatus('server-status', '服务状态', 'offline', '离线');
                document.getElementById('response-time').textContent = '超时';
            }
        }

        // 检查文件状态
        async function checkFilesStatus() {
            const files = [
                { name: '完整游戏', url: '/game.html' },
                { name: '快速试玩', url: '/play-game.html' },
                { name: '测试中心', url: '/complete-test.html' },
                { name: '启动中心', url: '/launch-game.html' }
            ];

            for (const file of files) {
                try {
                    const response = await fetch(file.url, { method: 'HEAD' });
                    if (response.ok) {
                        updateStatus('files-status', file.name, 'online', '可用');
                    } else {
                        updateStatus('files-status', file.name, 'offline', '错误');
                    }
                } catch (error) {
                    updateStatus('files-status', file.name, 'offline', '缺失');
                }
            }
        }

        // 检查资源状态
        async function checkResourcesStatus() {
            const resources = [
                { name: '样式文件', url: '/styles/cyber-theme.css' },
                { name: '核心脚本', url: '/src/game.js' },
                { name: '测试框架', url: '/tests/TestRunner.html' },
                { name: '粒子效果', url: '/scripts/ParticleEffects.js' }
            ];

            for (const resource of resources) {
                try {
                    const response = await fetch(resource.url, { method: 'HEAD' });
                    if (response.ok) {
                        updateStatus('resources-status', resource.name, 'online', '正常');
                    } else {
                        updateStatus('resources-status', resource.name, 'offline', '错误');
                    }
                } catch (error) {
                    updateStatus('resources-status', resource.name, 'offline', '缺失');
                }
            }
        }

        // 检查浏览器兼容性
        function checkBrowserCompatibility() {
            const checks = [
                {
                    name: 'Canvas 2D',
                    test: () => {
                        const canvas = document.createElement('canvas');
                        return !!(canvas.getContext && canvas.getContext('2d'));
                    }
                },
                {
                    name: 'ES6 支持',
                    test: () => {
                        try {
                            eval('const x = () => {};');
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                },
                {
                    name: '本地存储',
                    test: () => {
                        try {
                            localStorage.setItem('test', 'test');
                            localStorage.removeItem('test');
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                },
                {
                    name: '性能API',
                    test: () => {
                        return !!(window.performance && window.performance.now);
                    }
                }
            ];

            checks.forEach(check => {
                const result = check.test();
                updateStatus('browser-status', check.name, result ? 'online' : 'offline', result ? '支持' : '不支持');
            });
        }

        // 更新状态指示器
        function updateStatus(containerId, itemName, status, text) {
            const container = document.getElementById(containerId);
            const items = container.querySelectorAll('.status-item');
            
            items.forEach(item => {
                const label = item.querySelector('span').textContent;
                if (label === itemName) {
                    const indicator = item.querySelector('.status-indicator');
                    indicator.className = `status-indicator status-${status}`;
                    indicator.textContent = text;
                }
            });
        }

        // 检查所有状态
        async function checkAllStatus() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            
            await Promise.all([
                checkServerStatus(),
                checkFilesStatus(),
                checkResourcesStatus()
            ]);
            
            checkBrowserCompatibility();
        }

        // 切换自动刷新
        function toggleAutoRefresh() {
            autoRefreshEnabled = !autoRefreshEnabled;
            const button = event.target;
            
            if (autoRefreshEnabled) {
                button.textContent = '⏸️ 暂停自动刷新';
                startCountdown();
            } else {
                button.textContent = '▶️ 启动自动刷新';
                clearInterval(countdownInterval);
                document.getElementById('countdown').textContent = '--';
            }
        }

        // 启动倒计时
        function startCountdown() {
            let seconds = 10;
            document.getElementById('countdown').textContent = seconds;
            
            countdownInterval = setInterval(() => {
                seconds--;
                document.getElementById('countdown').textContent = seconds;
                
                if (seconds <= 0) {
                    if (autoRefreshEnabled) {
                        checkAllStatus();
                        seconds = 10;
                    }
                }
            }, 1000);
        }

        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', () => {
            checkAllStatus();
            startCountdown();
            
            console.log('🎮 游戏系统状态监控已启动');
        });
    </script>
</body>
</html>
