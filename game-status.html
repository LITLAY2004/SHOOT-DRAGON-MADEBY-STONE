<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® æ¸¸æˆç³»ç»ŸçŠ¶æ€ - å®æ—¶ç›‘æ§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #4fd1c7, #06b6d4);
            background-clip: text;
            -webkit-background-clip: text;
            color: transparent;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .card-title {
            font-size: 1.2rem;
            color: #4fd1c7;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-item:last-child {
            border-bottom: none;
        }

        .status-indicator {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .status-online { background: #10b981; color: white; }
        .status-offline { background: #ef4444; color: white; }
        .status-loading { background: #f59e0b; color: white; }

        .refresh-button {
            background: linear-gradient(45deg, #4fd1c7, #06b6d4);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 209, 199, 0.4);
        }

        .game-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .game-link {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 8px;
            padding: 15px;
            text-decoration: none;
            color: #4fd1c7;
            text-align: center;
            transition: all 0.3s ease;
            display: block;
        }

        .game-link:hover {
            background: rgba(79, 209, 199, 0.1);
            border-color: #4fd1c7;
            transform: translateY(-2px);
        }

        .auto-refresh {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(79, 209, 199, 0.3);
            border-radius: 8px;
            padding: 10px;
            font-size: 0.9rem;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .loading {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="auto-refresh">
        <div>ğŸ”„ è‡ªåŠ¨åˆ·æ–°: <span id="countdown">10</span>s</div>
        <div>ğŸ“Š æœ€åæ›´æ–°: <span id="lastUpdate">--:--:--</span></div>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ® æ¸¸æˆç³»ç»ŸçŠ¶æ€ç›‘æ§</h1>
            <div>
                <button class="refresh-button" onclick="checkAllStatus()">ğŸ”„ ç«‹å³åˆ·æ–°</button>
                <button class="refresh-button" onclick="toggleAutoRefresh()">â¸ï¸ æš‚åœè‡ªåŠ¨åˆ·æ–°</button>
            </div>
        </div>

        <div class="status-grid">
            <!-- HTTPæœåŠ¡å™¨çŠ¶æ€ -->
            <div class="status-card">
                <h3 class="card-title">ğŸŒ HTTPæœåŠ¡å™¨</h3>
                <div id="server-status">
                    <div class="status-item">
                        <span>æœåŠ¡çŠ¶æ€</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>ç«¯å£</span>
                        <span>8000</span>
                    </div>
                    <div class="status-item">
                        <span>å“åº”æ—¶é—´</span>
                        <span id="response-time">--ms</span>
                    </div>
                </div>
            </div>

            <!-- æ¸¸æˆæ–‡ä»¶çŠ¶æ€ -->
            <div class="status-card">
                <h3 class="card-title">ğŸ“ æ¸¸æˆæ–‡ä»¶</h3>
                <div id="files-status">
                    <div class="status-item">
                        <span>å®Œæ•´æ¸¸æˆ</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>å¿«é€Ÿè¯•ç©</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>æµ‹è¯•ä¸­å¿ƒ</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>å¯åŠ¨ä¸­å¿ƒ</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                </div>
            </div>

            <!-- æ¸¸æˆèµ„æºçŠ¶æ€ -->
            <div class="status-card">
                <h3 class="card-title">âš™ï¸ æ¸¸æˆèµ„æº</h3>
                <div id="resources-status">
                    <div class="status-item">
                        <span>æ ·å¼æ–‡ä»¶</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>æ ¸å¿ƒè„šæœ¬</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>æµ‹è¯•æ¡†æ¶</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>ç²’å­æ•ˆæœ</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                </div>
            </div>

            <!-- æµè§ˆå™¨å…¼å®¹æ€§ -->
            <div class="status-card">
                <h3 class="card-title">ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§</h3>
                <div id="browser-status">
                    <div class="status-item">
                        <span>Canvas 2D</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>ES6 æ”¯æŒ</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>æœ¬åœ°å­˜å‚¨</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                    <div class="status-item">
                        <span>æ€§èƒ½API</span>
                        <span class="status-indicator loading">æ£€æŸ¥ä¸­...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- å¿«é€Ÿè®¿é—®é“¾æ¥ -->
        <div class="game-links">
            <a href="launch-game.html" class="game-link" target="_blank">
                ğŸš€ æ¸¸æˆå¯åŠ¨ä¸­å¿ƒ
            </a>
            <a href="game.html" class="game-link" target="_blank">
                ğŸ® å®Œæ•´æ¸¸æˆ
            </a>
            <a href="play-game.html" class="game-link" target="_blank">
                âš¡ å¿«é€Ÿè¯•ç©
            </a>
            <a href="complete-test.html" class="game-link" target="_blank">
                ğŸ§ª æµ‹è¯•ä¸­å¿ƒ
            </a>
            <a href="tests/TestRunner.html" class="game-link" target="_blank">
                ğŸ”¬ å•å…ƒæµ‹è¯•
            </a>
            <a href="index.html" class="game-link" target="_blank">
                ğŸ  é¡¹ç›®ä¸»é¡µ
            </a>
        </div>
    </div>

    <script>
        let autoRefreshEnabled = true;
        let refreshInterval;
        let countdownInterval;

        // æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€
        async function checkServerStatus() {
            const start = performance.now();
            try {
                const response = await fetch('/');
                const end = performance.now();
                const responseTime = Math.round(end - start);
                
                document.getElementById('response-time').textContent = responseTime + 'ms';
                
                if (response.ok) {
                    updateStatus('server-status', 'æœåŠ¡çŠ¶æ€', 'online', 'åœ¨çº¿');
                } else {
                    updateStatus('server-status', 'æœåŠ¡çŠ¶æ€', 'offline', 'å¼‚å¸¸');
                }
            } catch (error) {
                updateStatus('server-status', 'æœåŠ¡çŠ¶æ€', 'offline', 'ç¦»çº¿');
                document.getElementById('response-time').textContent = 'è¶…æ—¶';
            }
        }

        // æ£€æŸ¥æ–‡ä»¶çŠ¶æ€
        async function checkFilesStatus() {
            const files = [
                { name: 'å®Œæ•´æ¸¸æˆ', url: '/game.html' },
                { name: 'å¿«é€Ÿè¯•ç©', url: '/play-game.html' },
                { name: 'æµ‹è¯•ä¸­å¿ƒ', url: '/complete-test.html' },
                { name: 'å¯åŠ¨ä¸­å¿ƒ', url: '/launch-game.html' }
            ];

            for (const file of files) {
                try {
                    const response = await fetch(file.url, { method: 'HEAD' });
                    if (response.ok) {
                        updateStatus('files-status', file.name, 'online', 'å¯ç”¨');
                    } else {
                        updateStatus('files-status', file.name, 'offline', 'é”™è¯¯');
                    }
                } catch (error) {
                    updateStatus('files-status', file.name, 'offline', 'ç¼ºå¤±');
                }
            }
        }

        // æ£€æŸ¥èµ„æºçŠ¶æ€
        async function checkResourcesStatus() {
            const resources = [
                { name: 'æ ·å¼æ–‡ä»¶', url: '/styles/cyber-theme.css' },
                { name: 'æ ¸å¿ƒè„šæœ¬', url: '/src/game.js' },
                { name: 'æµ‹è¯•æ¡†æ¶', url: '/tests/TestRunner.html' },
                { name: 'ç²’å­æ•ˆæœ', url: '/scripts/ParticleEffects.js' }
            ];

            for (const resource of resources) {
                try {
                    const response = await fetch(resource.url, { method: 'HEAD' });
                    if (response.ok) {
                        updateStatus('resources-status', resource.name, 'online', 'æ­£å¸¸');
                    } else {
                        updateStatus('resources-status', resource.name, 'offline', 'é”™è¯¯');
                    }
                } catch (error) {
                    updateStatus('resources-status', resource.name, 'offline', 'ç¼ºå¤±');
                }
            }
        }

        // æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§
        function checkBrowserCompatibility() {
            const checks = [
                {
                    name: 'Canvas 2D',
                    test: () => {
                        const canvas = document.createElement('canvas');
                        return !!(canvas.getContext && canvas.getContext('2d'));
                    }
                },
                {
                    name: 'ES6 æ”¯æŒ',
                    test: () => {
                        try {
                            eval('const x = () => {};');
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                },
                {
                    name: 'æœ¬åœ°å­˜å‚¨',
                    test: () => {
                        try {
                            localStorage.setItem('test', 'test');
                            localStorage.removeItem('test');
                            return true;
                        } catch (e) {
                            return false;
                        }
                    }
                },
                {
                    name: 'æ€§èƒ½API',
                    test: () => {
                        return !!(window.performance && window.performance.now);
                    }
                }
            ];

            checks.forEach(check => {
                const result = check.test();
                updateStatus('browser-status', check.name, result ? 'online' : 'offline', result ? 'æ”¯æŒ' : 'ä¸æ”¯æŒ');
            });
        }

        // æ›´æ–°çŠ¶æ€æŒ‡ç¤ºå™¨
        function updateStatus(containerId, itemName, status, text) {
            const container = document.getElementById(containerId);
            const items = container.querySelectorAll('.status-item');
            
            items.forEach(item => {
                const label = item.querySelector('span').textContent;
                if (label === itemName) {
                    const indicator = item.querySelector('.status-indicator');
                    indicator.className = `status-indicator status-${status}`;
                    indicator.textContent = text;
                }
            });
        }

        // æ£€æŸ¥æ‰€æœ‰çŠ¶æ€
        async function checkAllStatus() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            
            await Promise.all([
                checkServerStatus(),
                checkFilesStatus(),
                checkResourcesStatus()
            ]);
            
            checkBrowserCompatibility();
        }

        // åˆ‡æ¢è‡ªåŠ¨åˆ·æ–°
        function toggleAutoRefresh() {
            autoRefreshEnabled = !autoRefreshEnabled;
            const button = event.target;
            
            if (autoRefreshEnabled) {
                button.textContent = 'â¸ï¸ æš‚åœè‡ªåŠ¨åˆ·æ–°';
                startCountdown();
            } else {
                button.textContent = 'â–¶ï¸ å¯åŠ¨è‡ªåŠ¨åˆ·æ–°';
                clearInterval(countdownInterval);
                document.getElementById('countdown').textContent = '--';
            }
        }

        // å¯åŠ¨å€’è®¡æ—¶
        function startCountdown() {
            let seconds = 10;
            document.getElementById('countdown').textContent = seconds;
            
            countdownInterval = setInterval(() => {
                seconds--;
                document.getElementById('countdown').textContent = seconds;
                
                if (seconds <= 0) {
                    if (autoRefreshEnabled) {
                        checkAllStatus();
                        seconds = 10;
                    }
                }
            }, 1000);
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            checkAllStatus();
            startCountdown();
            
            console.log('ğŸ® æ¸¸æˆç³»ç»ŸçŠ¶æ€ç›‘æ§å·²å¯åŠ¨');
        });
    </script>
</body>
</html>
